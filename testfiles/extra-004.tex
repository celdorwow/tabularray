\documentclass{article}

\input{regression-test}

\usepackage{xcolor}

\setlength{\parindent}{0pt}

\ExplSyntaxOn
\NewTblrChildIndexer{Hello}
  {
    \clist_set:Nn \lTblrChildClist {{5}{5}}
  }
\NewTblrChildSelector{world}
  {
    \clist_set:Nn \lTblrChildClist {{1}{2},{2}{1},{3}{4},{4}{3}}
  }
\ExplSyntaxOff

\begin{document}

\hrule\bigskip

\START

\BEGINTEST{child tuples: diagonal selection} % issue #381
\begin{tblr}{
  hline{1,Z},
  cell{{2}{4},{7}{3}} = {bg=blue7},
  cell{{1}{1}-{4}{4},{5}{8}-{8}{5}} = {bg=red7},
  cell{{4}{3}-{1}{1},{6}{5}-{4}{8}} = {bg=green7},
}
  1	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  2	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  3	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  4	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  5	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  6	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  7	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  8	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
\end{tblr}
\ENDTEST

\bigskip\hrule\bigskip

\BEGINTEST{child tuples: indexers and selectors} % issue #381
\begin{tblr}{
  hline{1,Z},
  cell{{7}{6},Hello,{8}{7},world,{6}{8}} = {bg=yellow7},
}
  1	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  2	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  3	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  4	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  5	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  6	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  7	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
  8	& 2	& 3	& 4	& 5	& 6	& 7 & 8 \\
\end{tblr}
\ENDTEST

\end{document}
