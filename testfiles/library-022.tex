\documentclass{article}

\input{regression-test}
\geometry{a6paper,margin=15mm}

\UseTblrLibrary{tikz}
\usetikzlibrary{patterns}
\setlength{\parindent}{0pt}

\begin{document}

\START

\BEGINTEST{longtblr tikz: multiple pages}
\ExplSyntaxOn
\cs_generate_variant:Nn \clist_map_inline:nn {e}
\cs_new_protected:Npn \mymagic #1
  {
    \clist_map_inline:en {\ExpTblrChildClass {#1}}
      {
        \bool_lazy_and:nnT
          { \int_compare_p:n {\lTblrRowFirstInt <= \use_i:nn ##1} }
          { \int_compare_p:n {\lTblrRowLastInt >= \use_i:nn ##1} }
          { \exp_args:Noo \mymagicfill {\use_i:nn ##1} {\use_ii:nn ##1} }
      }
  }
\ExplSyntaxOff
\newcommand\mymagicfill[2]{
  \fill[teal7] (#1-#2.north west) rectangle (#1-#2.south east);
}
\begin{tblrtikzbelow}
%  \fill[pattern color=lightgray,pattern=crosshatch]
%    (table.north east) rectangle (table.south west);
  \mymagic{magic}
\end{tblrtikzbelow}%
\begin{longtblr}[
  caption = Long Table Tikz
]{
  rowhead=2,
  rowfoot=1,
  hlines={wd=4pt},vlines={wd=3pt},colspec={*{5}{X[r]}}
}
  Head1 & Head2 & Head3 & Head4 & Head5 \\
  Head1 & Head2 & Head3 & Head4 & Head5 \\
    3-1 &   3-2 &   3-3 &   3-4 &   3-5 \\
    4-1 &   4-2 &   4-3 &   \SetChild{class=magic}4-4
                                &   4-5 \\
    5-1 &   5-2 &   5-3 &   5-4 &   5-5 \\
    6-1 &   6-2 &   6-3 &   6-4 &   6-5 \\
    7-1 &   \SetChild{class=magic}7-2
                &   7-3 &   7-4 &   7-5 \\
    8-1 &   8-2 &   8-3 &   8-4 & \SetChild{class=magic}8-5 \\
    9-1 &   9-2 &   9-3 &   9-4 &   9-5 \\
   10-1 &  10-2 &  10-3 &  10-4 &  10-5 \\
   11-1 &  11-2 &  11-3 &  11-4 &  11-5 \\
   \SetChild{class=magic}12-1
        &  12-2 &  12-3 &  12-4 &  12-5 \\
   13-1 &  13-2 &  13-3 &  13-4 &  13-5 \\
   14-1 &  14-2 &  14-3 &  14-4 &  14-5 \\
   15-1 &  15-2 &  15-3 &  15-4 &  \SetChild{class=magic}15-5 \\
   16-1 &  16-2 &  16-3 &  16-4 &  16-5 \\
   17-1 &  17-2 &  17-3 &  17-4 &  17-5 \\
   18-1 &  18-2 &  18-3 &  18-4 &  18-5 \\
   19-1 &  19-2 & \SetChild{class=magic}19-3
                        &  19-4 &  19-5 \\
   20-1 &  20-2 &  20-3 &  20-4 &  20-5 \\
   21-1 &  21-2 &  21-3 &  21-4 &  21-5 \\
   22-1 &  \SetChild{class=magic}22-2
                &  22-3 &  22-4 &  22-5 \\
   23-1 &  23-2 &  23-3 &  23-4 &  23-5 \\
   24-1 &  24-2 &  24-3 &  24-4 &  24-5 \\
   \SetChild{class=magic}25-1
        &  25-2 &  25-3 &  25-4 &  25-5 \\
   26-1 &  26-2 &  26-3 &  26-4 &  26-5 \\
   27-1 &  27-2 &  27-3 &  27-4 &  27-5 \\
   28-1 &  28-2 &  28-3 &  28-4 &  28-5 \\
   29-1 &  29-2 &  29-3 &  29-4 &  29-5 \\
   30-1 &  30-2 &  30-3 &  \SetChild{class=magic}30-4
                                &  30-5 \\
   31-1 &  31-2 &  31-3 &  31-4 &  31-5 \\
   32-1 &  32-2 &  32-3 &  32-4 &  32-5 \\
   33-1 &  33-2 &  33-3 &  33-4 &  33-5 \\
   34-1 &  \SetChild{class=magic}34-2
                &  34-3 &  34-4 &  34-5 \\
   35-1 &  35-2 &  35-3 &  35-4 &  35-5 \\
   36-1 &  36-2 &  36-3 &  36-4 &  36-5 \\
   37-1 &  37-2 &  \SetChild{class=magic}37-3
                        &  37-4 &  37-5 \\
   38-1 &  38-2 &  38-3 &  38-4 &  38-5 \\
  Foot1 & Foot2 & Foot3 & Foot4 & Foot5 \\
\end{longtblr}
\ENDTEST

\end{document}
