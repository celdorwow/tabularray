\documentclass{article}
\usepackage[b5paper,margin=1cm]{geometry}
\pagestyle{empty}
\setlength{\parindent}{0pt}

\input{regression-test}

% avoid font size substitution messages from "LaTeX Font Info"
\usepackage{type1cm,type1ec}

\usepackage{tabularray}
\UseTblrLibrary{counter}
\SetTblrInner{rowsep=0pt}

\usepackage{array}

\SetTblrTracing{none}
\UseTblrLibrary{hook}

\begin{document}

\START
\hrule\bigskip

\newcounter{mycnt}

\BEGINTEST{counter library: text mode}
\setcounter{mycnt}{4}%
\begin{tabular}{|l|l|}
\hline
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
\hline
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
\hline
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
\hline
\end{tabular}
\quad\setcounter{mycnt}{4}%
\begin{tblr}{cells={l},hlines,vlines}
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
\end{tblr}
\ENDTEST

\bigskip\hrule\bigskip

\BEGINTEST{counter library: math mode}
\setcounter{mycnt}{4}%
$\begin{array}{|l|l|}
\hline
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
\hline
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
\hline
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
\hline
\end{array}$
\quad\setcounter{mycnt}{4}%
$\begin{tblr}{cells={l},hlines,vlines}
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
  \stepcounter{mycnt}\arabic{mycnt} & \stepcounter{mycnt}\arabic{mycnt} \\
\end{tblr}$
\ENDTEST

\end{document}
